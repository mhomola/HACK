import numpy as np
import matplotlib.pyplot as plt
import FCParameters as fc
import Battery_Sizing as BS
import Polarization_curve_model as PCM

SF = fc.SF
FC_power = SF*0.001*BS.final_bat_size()[0]
B_cost = BS.final_bat_size()[1]
B_mass = BS.final_bat_size()[2]
B_volume = BS.final_bat_size()[3]

Vc = fc.Vc
sp_W = 0.8
sp_V = 0.8
sp_C = 35*0.85 #All 3 of them from DOE

# Mirai data
PMirai = 114 # kW
Ncells = 370
VMirai = 37 #l
mMirai = 56 #kg
VpCell = VMirai/Ncells
mpCell = mMirai/Ncells

PtoN = 114/370

def calc_current(V):
    return FC_power/V

def calc_cur_density(Vc):
    return PCM.inverse(Vc)

def FC_sizing():

    V = 1500 #V
    n_series = round(V/Vc)
    I = calc_current(V)
    iden = calc_cur_density(Vc)

    n_paral = FC_power/PtoN

    n_cells = n_series*n_paral

    V_stack = n_cells*VpCell
    m_stack = n_cells*mpCell

    A = I/iden
    l = V_stack/A
    l_cell = l/n_series

    return [n_series, n_paral, n_cells, I, iden, V_stack, m_stack, A, l, l_cell]

if __name__ == '__main__':

    sizing = FC_sizing()

    print()
    print('Sizing of the fuel cell results:')
    print('Number of cells in series:')
    print('Number of cells in parallel:')
    prin









